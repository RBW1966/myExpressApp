var socket = null;
var user_id = null;
var terminated = false;
var timer;
var timeout = (function () {
    return function () {
        window.clearTimeout(timer);
        timer = window.setTimeout(() => {
            // Nothing to do
        }, 5000);
    };
})();
window.addEventListener('load', () => {
    secured_doIt();
});
// Disable key press
function secured_disableKeyPressing(e) {
    // keycode for F5 function
    if (e.keyCode === 116) {
        e.returnValue = false;
        e.keyCode = 0;
        return false;
    }
    // keycode for Ctrl+R
    if (e.keyCode === 82) {
        if (e.ctrlKey) {
            e.returnValue = false;
            e.keyCode = 0;
            return false;
        }
    }
    // keycode for backspace
    if (e.keyCode === 8) {
        // try to cancel the backspace
        e.returnValue = false;
        e.keyCode = 0;
        return false;
    }
}
function secured_doDisconnect() {
    if (terminated)
        return;
    console.log('doDisconnect');
    alert('Lost connection to myExpressApp.');
    socket.open();
}
function secured_doLogout() {
    terminated = true;
    console.log('doLogout');
    location.href = "/logout";
}
function secured_doRecon() {
    console.log('doRecon');
    socket.close();
}
function secured_doTerminate() {
    terminated = true;
    console.log('doTerminate');
    alert('myExpressApp is offline.');
    location.href = "https://github.com/RBW1966/myExpressApp";
}
function secured_doConnect() {
    socket.emit('register user', user_id);
}
function secured_doIt() {
    user_id = secured_getCookie("USER_ID");
    console.log(`secured_myID=${user_id}`);
    socket = io();
    socket.on('terminate', secured_doTerminate);
    socket.on('logout', secured_doLogout);
    socket.on('recon', secured_doRecon);
    socket.on('disconnect', secured_doDisconnect);
    socket.on('connect', secured_doConnect);
    socket.emit('register user', user_id);
    // Manipulate DOM
    document.addEventListener('keydown', (e) => {
        // F5 is pressed
        if ((e.which || e.keyCode) == 116) {
            secured_disableKeyPressing(e);
            console.log('F5 was ignored.');
        }
        // Backspace
        if (e.keyCode == 8) {
            console.log(e.target.id);
            switch (e.target.id) {
                case "m":
                    break;
                default:
                    secured_disableKeyPressing(e);
                    console.log('Backspace was ignored.');
            }
        }
        // Ctrl+R
        if (e.ctrlKey && (e.which === 82)) {
            secured_disableKeyPressing(e);
            console.log('Ctrl+R was ignored.');
        }
    });
}
function secured_getCookie(cname) {
    var name = cname + "=";
    var decodedCookie = decodeURIComponent(document.cookie);
    var ca = decodedCookie.split(';');
    for (var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') {
            c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
            return c.substring(name.length, c.length);
        }
    }
    return "";
}
function secured_displayApp(evt, appName) {
    var i, x, tablinks;
    x = document.getElementsByClassName("app");
    for (i = 0; i < x.length; i++) {
        x[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablink");
    for (i = 0; i < x.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" w3-red", "");
    }
    document.getElementById(appName).style.display = "block";
    evt.currentTarget.className += " w3-red";
}
function w3_open() {
    document.getElementById("main").style.marginLeft = "25%";
    document.getElementById("mySidebar").style.width = "25%";
    document.getElementById("mySidebar").style.display = "block";
    document.getElementById("openNav").style.display = 'none';
}
function w3_close() {
    document.getElementById("main").style.marginLeft = "0%";
    document.getElementById("mySidebar").style.display = "none";
    document.getElementById("openNav").style.display = "inline-block";
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VjdXJlZC5hcHAuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJzZWN1cmVkLmFwcC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxJQUFJLE1BQU0sR0FBRyxJQUFJLENBQUM7QUFDbEIsSUFBSSxPQUFPLEdBQUcsSUFBSSxDQUFDO0FBQ25CLElBQUksVUFBVSxHQUFHLEtBQUssQ0FBQztBQUN2QixJQUFJLEtBQUssQ0FBQztBQUVWLElBQUksT0FBTyxHQUFHLENBQUM7SUFDYixPQUFPO1FBQ0wsTUFBTSxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUMzQixLQUFLLEdBQUcsTUFBTSxDQUFDLFVBQVUsQ0FBRSxHQUFHLEVBQUU7WUFDOUIsZ0JBQWdCO1FBQ2xCLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNYLENBQUMsQ0FBQTtBQUNILENBQUMsQ0FBQyxFQUFFLENBQUM7QUFFTCxNQUFNLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRTtJQUNuQyxZQUFZLEVBQUUsQ0FBQztBQUNqQixDQUFDLENBQUMsQ0FBQztBQUNILG9CQUFvQjtBQUNwQixTQUFTLDBCQUEwQixDQUFDLENBQUM7SUFDL0IsMEJBQTBCO0lBQzFCLElBQUksQ0FBQyxDQUFDLE9BQU8sS0FBSyxHQUFHLEVBQUU7UUFDckIsQ0FBQyxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUM7UUFDdEIsQ0FBQyxDQUFDLE9BQU8sR0FBRyxDQUFDLENBQUM7UUFDZCxPQUFPLEtBQUssQ0FBQztLQUNkO0lBQ0QscUJBQXFCO0lBQ3JCLElBQUksQ0FBQyxDQUFDLE9BQU8sS0FBSyxFQUFFLEVBQUU7UUFDcEIsSUFBSSxDQUFDLENBQUMsT0FBTyxFQUFFO1lBQ2IsQ0FBQyxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUM7WUFDdEIsQ0FBQyxDQUFDLE9BQU8sR0FBRyxDQUFDLENBQUM7WUFDZCxPQUFPLEtBQUssQ0FBQztTQUNkO0tBQ0Y7SUFDRCx3QkFBd0I7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QUMsY0FBYyxDQUFDLFdBQVcsQ0FBQyxDQUFDLEtBQUssQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDO0lBQzVELFFBQVEsQ0FBQyxjQUFjLENBQUMsU0FBUyxDQUFDLENBQUMsS0FBSyxDQUFDLE9BQU8sR0FBRyxjQUFjLENBQUM7QUFDcEUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbInZhciBzb2NrZXQgPSBudWxsO1xyXG52YXIgdXNlcl9pZCA9IG51bGw7XHJcbnZhciB0ZXJtaW5hdGVkID0gZmFsc2U7XHJcbnZhciB0aW1lcjtcclxuXHJcbnZhciB0aW1lb3V0ID0gKGZ1bmN0aW9uICgpIHtcclxuICByZXR1cm4gZnVuY3Rpb24oKSB7XHJcbiAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRpbWVyKTtcclxuICAgIHRpbWVyID0gd2luZG93LnNldFRpbWVvdXQoICgpID0+IHtcclxuICAgICAgLy8gTm90aGluZyB0byBkb1xyXG4gICAgfSwgNTAwMCk7XHJcbiAgfVxyXG59KSgpO1xyXG5cclxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoKSA9PiB7XHJcbiAgc2VjdXJlZF9kb0l0KCk7XHJcbn0pO1xyXG4vLyBEaXNhYmxlIGtleSBwcmVzc1xyXG5mdW5jdGlvbiBzZWN1cmVkX2Rpc2FibGVLZXlQcmVzc2luZyhlKSB7XHJcbiAgICAgIC8vIGtleWNvZGUgZm9yIEY1IGZ1bmN0aW9uXHJcbiAgICAgIGlmIChlLmtleUNvZGUgPT09IDExNikge1xyXG4gICAgICAgIGUucmV0dXJuVmFsdWUgPSBmYWxzZTtcclxuICAgICAgICBlLmtleUNvZGUgPSAwO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICAvLyBrZXljb2RlIGZvciBDdHJsK1JcclxuICAgICAgaWYgKGUua2V5Q29kZSA9PT0gODIpIHtcclxuICAgICAgICBpZiAoZS5jdHJsS2V5KSB7XHJcbiAgICAgICAgICBlLnJldHVyblZhbHVlID0gZmFsc2U7XHJcbiAgICAgICAgICBlLmtleUNvZGUgPSAwO1xyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlOyAgICAgICAgICBcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgLy8ga2V5Y29kZSBmb3IgYmFja3NwYWNlXHJcbiAgICAgIGlmIChlLmtleUNvZGUgPT09IDgpIHtcclxuICAgICAgICAvLyB0cnkgdG8gY2FuY2VsIHRoZSBiYWNrc3BhY2VcclxuICAgICAgICBlLnJldHVyblZhbHVlID0gZmFsc2U7XHJcbiAgICAgICAgZS5rZXlDb2RlID0gMDtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxufVxyXG5mdW5jdGlvbiBzZWN1cmVkX2RvRGlzY29ubmVjdCgpIHtcclxuICBpZiAodGVybWluYXRlZCkgcmV0dXJuO1xyXG4gIGNvbnNvbGUubG9nKCdkb0Rpc2Nvbm5lY3QnKTtcclxuICBhbGVydCgnTG9zdCBjb25uZWN0aW9uIHRvIG15RXhwcmVzc0FwcC4nKTtcclxuICBzb2NrZXQub3BlbigpO1xyXG59XHJcbmZ1bmN0aW9uIHNlY3VyZWRfZG9Mb2dvdXQoKSB7XHJcbiAgdGVybWluYXRlZCA9IHRydWU7XHJcbiAgY29uc29sZS5sb2coJ2RvTG9nb3V0Jyk7XHJcbiAgbG9jYXRpb24uaHJlZiA9IFwiL2xvZ291dFwiO1xyXG59XHJcbmZ1bmN0aW9uIHNlY3VyZWRfZG9SZWNvbigpIHtcclxuICBjb25zb2xlLmxvZygnZG9SZWNvbicpO1xyXG4gIHNvY2tldC5jbG9zZSgpO1xyXG59XHJcbmZ1bmN0aW9uIHNlY3VyZWRfZG9UZXJtaW5hdGUoKSB7XHJcbiAgdGVybWluYXRlZCA9IHRydWU7XHJcbiAgY29uc29sZS5sb2coJ2RvVGVybWluYXRlJyk7XHJcbiAgYWxlcnQoJ215RXhwcmVzc0FwcCBpcyBvZmZsaW5lLicpO1xyXG4gIGxvY2F0aW9uLmhyZWYgPVwiaHR0cHM6Ly9naXRodWIuY29tL1JCVzE5NjYvbXlFeHByZXNzQXBwXCI7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNlY3VyZWRfZG9Db25uZWN0KCkge1xyXG4gIHNvY2tldC5lbWl0KCdyZWdpc3RlciB1c2VyJywgdXNlcl9pZCk7XHJcbn1cclxuZnVuY3Rpb24gc2VjdXJlZF9kb0l0KCkge1xyXG4gIHVzZXJfaWQgPSBzZWN1cmVkX2dldENvb2tpZShcIlVTRVJfSURcIik7XHJcbiAgY29uc29sZS5sb2coYHNlY3VyZWRfbXlJRD0ke3VzZXJfaWR9YCk7XHJcbiAgc29ja2V0ID0gaW8oKTtcclxuICBzb2NrZXQub24oJ3Rlcm1pbmF0ZScsIHNlY3VyZWRfZG9UZXJtaW5hdGUpO1xyXG4gIHNvY2tldC5vbignbG9nb3V0Jywgc2VjdXJlZF9kb0xvZ291dCk7XHJcbiAgc29ja2V0Lm9uKCdyZWNvbicsIHNlY3VyZWRfZG9SZWNvbik7XHJcbiAgc29ja2V0Lm9uKCdkaXNjb25uZWN0Jywgc2VjdXJlZF9kb0Rpc2Nvbm5lY3QpO1xyXG4gIHNvY2tldC5vbignY29ubmVjdCcsIHNlY3VyZWRfZG9Db25uZWN0KTtcclxuICBzb2NrZXQuZW1pdCgncmVnaXN0ZXIgdXNlcicsIHVzZXJfaWQpO1xyXG4gIC8vIE1hbmlwdWxhdGUgRE9NXHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKSA9PiB7XHJcbiAgICAvLyBGNSBpcyBwcmVzc2VkXHJcbiAgICBpZigoZS53aGljaCB8fCBlLmtleUNvZGUpID09IDExNikge1xyXG4gICAgICBzZWN1cmVkX2Rpc2FibGVLZXlQcmVzc2luZyhlKTtcclxuICAgICAgY29uc29sZS5sb2coJ0Y1IHdhcyBpZ25vcmVkLicpO1xyXG4gICAgfVxyXG4gICAgLy8gQmFja3NwYWNlXHJcbiAgICBpZiAoZS5rZXlDb2RlID09IDgpIHtcclxuICAgICAgY29uc29sZS5sb2coKDxIVE1MSW5wdXRFbGVtZW50PmUudGFyZ2V0KS5pZCk7XHJcbiAgICAgIHN3aXRjaCAoKDxIVE1MSW5wdXRFbGVtZW50PmUudGFyZ2V0KS5pZCkge1xyXG4gICAgICAgIGNhc2UgXCJtXCI6XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgc2VjdXJlZF9kaXNhYmxlS2V5UHJlc3NpbmcoZSk7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZygnQmFja3NwYWNlIHdhcyBpZ25vcmVkLicpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBDdHJsK1JcclxuICAgIGlmIChlLmN0cmxLZXkgJiYgKGUud2hpY2ggPT09IDgyKSApIHtcclxuICAgICAgc2VjdXJlZF9kaXNhYmxlS2V5UHJlc3NpbmcoZSk7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdDdHJsK1Igd2FzIGlnbm9yZWQuJyk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNlY3VyZWRfZ2V0Q29va2llKGNuYW1lKSB7XHJcbiAgdmFyIG5hbWUgPSBjbmFtZSArIFwiPVwiO1xyXG4gIHZhciBkZWNvZGVkQ29va2llID0gZGVjb2RlVVJJQ29tcG9uZW50KGRvY3VtZW50LmNvb2tpZSk7XHJcbiAgdmFyIGNhID0gZGVjb2RlZENvb2tpZS5zcGxpdCgnOycpO1xyXG4gIGZvcih2YXIgaSA9IDA7IGkgPGNhLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIHZhciBjID0gY2FbaV07XHJcbiAgICAgIHdoaWxlIChjLmNoYXJBdCgwKSA9PSAnICcpIHtcclxuICAgICAgICAgIGMgPSBjLnN1YnN0cmluZygxKVxyXG4gICAgICB9XHJcbiAgICAgIGlmIChjLmluZGV4T2YobmFtZSkgPT0gMCkge1xyXG4gICAgICAgICAgcmV0dXJuIGMuc3Vic3RyaW5nKG5hbWUubGVuZ3RoLCBjLmxlbmd0aCk7XHJcbiAgICAgIH1cclxuICB9XHJcbiAgcmV0dXJuIFwiXCI7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNlY3VyZWRfZGlzcGxheUFwcChldnQsIGFwcE5hbWUpIHtcclxuICB2YXIgaSwgeCwgdGFibGlua3M7XHJcbiAgeCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJhcHBcIik7XHJcbiAgZm9yIChpID0gMDsgaSA8IHgubGVuZ3RoOyBpKyspIHtcclxuICAgIHhbaV0uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gIH1cclxuICB0YWJsaW5rcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJ0YWJsaW5rXCIpO1xyXG4gIGZvciAoaSA9IDA7IGkgPCB4Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICB0YWJsaW5rc1tpXS5jbGFzc05hbWUgPSB0YWJsaW5rc1tpXS5jbGFzc05hbWUucmVwbGFjZShcIiB3My1yZWRcIiwgXCJcIik7IFxyXG4gIH1cclxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChhcHBOYW1lKS5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gIGV2dC5jdXJyZW50VGFyZ2V0LmNsYXNzTmFtZSArPSBcIiB3My1yZWRcIjtcclxufVxyXG5cclxuZnVuY3Rpb24gdzNfb3BlbigpIHtcclxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1haW5cIikuc3R5bGUubWFyZ2luTGVmdCA9IFwiMjUlXCI7XHJcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJteVNpZGViYXJcIikuc3R5bGUud2lkdGggPSBcIjI1JVwiO1xyXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibXlTaWRlYmFyXCIpLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJvcGVuTmF2XCIpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbn1cclxuZnVuY3Rpb24gdzNfY2xvc2UoKSB7XHJcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtYWluXCIpLnN0eWxlLm1hcmdpbkxlZnQgPSBcIjAlXCI7XHJcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJteVNpZGViYXJcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwib3Blbk5hdlwiKS5zdHlsZS5kaXNwbGF5ID0gXCJpbmxpbmUtYmxvY2tcIjtcclxufSJdfQ==